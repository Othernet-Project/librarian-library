// Generated by CoffeeScript 1.10.0
(function(window, $, templates) {
  var DOWN, LEFT, RETURN, RIGHT, UP, buttons, buttonsByName, choices, importForm, initialValue, input, onActivate;
  RETURN = 13;
  LEFT = 37;
  RIGHT = 39;
  UP = 38;
  DOWN = 40;
  importForm = $('#import-step-fields');
  if (!importForm.length) {
    return;
  }
  initialValue = (importForm.find('select')).val();
  importForm.before(templates.stepImportChoices);
  importForm.remove();
  choices = $('#import-choices');
  input = $('#import-chosen-action');
  buttons = choices.find('li');
  buttonsByName = {
    "import": choices.find('#import-import'),
    ignore: choices.find('#import-ignore')
  };
  input.on('change', function(e) {
    var val;
    val = input.val();
    if (!val) {
      return;
    }
    buttons.removeClass('selected');
    return (buttonsByName[val].addClass('selected')).focus();
  });
  onActivate = function(e) {
    var elem, val;
    elem = $(this);
    val = elem.data('action');
    input.val(val);
    input.change();
  };
  choices.on('click', 'li', onActivate);
  choices.on('keydown', 'li', function(e) {
    var code;
    code = e.which;
    if (code === RETURN) {
      onActivate.call(this, e);
    }
    if (([LEFT, UP].indexOf(code)) > -1) {
      input.val('import');
      input.change();
    }
    if (([RIGHT, DOWN].indexOf(code)) > -1) {
      input.val('ignore');
      input.change();
    }
  });
  input.val(initialValue);
  input.change();
})(this, this.jQuery, this.templates);
